<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>esp1.fsr.runtime documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">fsr</span> <span class="project-version">main</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>esp1</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fsr</span></div></div></li><li class="depth-3 branch"><a href="esp1.fsr.cache.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cache</span></div></a></li><li class="depth-3 branch"><a href="esp1.fsr.compile.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compile</span></div></a></li><li class="depth-3 branch"><a href="esp1.fsr.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="esp1.fsr.ring.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ring</span></div></a></li><li class="depth-3 current"><a href="esp1.fsr.runtime.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>runtime</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="esp1.fsr.runtime.html#var-invoke-handler"><div class="inner"><span>invoke-handler</span></div></a></li><li class="depth-1"><a href="esp1.fsr.runtime.html#var-load-compiled-routes"><div class="inner"><span>load-compiled-routes</span></div></a></li><li class="depth-1"><a href="esp1.fsr.runtime.html#var-match-pattern-route"><div class="inner"><span>match-pattern-route</span></div></a></li><li class="depth-1"><a href="esp1.fsr.runtime.html#var-match-route"><div class="inner"><span>match-route</span></div></a></li><li class="depth-1"><a href="esp1.fsr.runtime.html#var-match-static-route"><div class="inner"><span>match-static-route</span></div></a></li><li class="depth-1"><a href="esp1.fsr.runtime.html#var-require-and-resolve"><div class="inner"><span>require-and-resolve</span></div></a></li><li class="depth-1"><a href="esp1.fsr.runtime.html#var-wrap-compiled-routes"><div class="inner"><span>wrap-compiled-routes</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">esp1.fsr.runtime</h1><div class="doc"><div class="markdown"><p>Runtime route matching for compiled routes (zero filesystem access).</p>
<p>Loads pre-compiled routes from EDN and matches requests efficiently. Routes are compiled at build time using <code>esp1.fsr.compile</code>.</p>
<h2><a href="#performance" id="performance"></a>Performance</h2>
<table>
<thead>
<tr><th> Route Type </th><th> Complexity </th><th> Notes                           </th></tr>
</thead>
<tbody>
<tr><td> Static     </td><td> O(1)       </td><td> Hash lookup by URI              </td></tr>
<tr><td> Pattern    </td><td> O(n)       </td><td> Sequential regex match, n=routes </td></tr>
</tbody>
</table>
<h2><a href="#usage" id="usage"></a>Usage</h2>
<pre><code class="language-clojure">(def app
  (-&gt; not-found-handler
      (wrap-compiled-routes {:compiled-routes-path "dist/compiled-routes.edn"})))
</code></pre>
<p>See <code>esp1.fsr.compile</code> for building the compiled routes.</p>
</div></div><div class="public anchor" id="var-invoke-handler"><h3>invoke-handler</h3><div class="usage"><code>(invoke-handler handler-info request)</code></div><div class="doc"><div class="markdown"><p>Invokes a matched handler with the request.</p>
<p>Args: - handler-info: Result from match-route - request: Ring request map</p>
<p>Returns: Ring response (map, string, or nil)</p>
</div></div><div class="src-link"><a href="https://github.com/esp1/fsr/blob/main/src/esp1/fsr/runtime.clj#L132">view source</a></div></div><div class="public anchor" id="var-load-compiled-routes"><h3>load-compiled-routes</h3><div class="usage"><code>(load-compiled-routes source)</code></div><div class="doc"><div class="markdown"><p>Loads compiled routes from an EDN file or resource.</p>
<p>Args: - source: Either a file path (string), java.io.File, or java.io.Reader</p>
<p>Returns: Compiled routes data structure with :static-routes and :pattern-routes</p>
</div></div><div class="src-link"><a href="https://github.com/esp1/fsr/blob/main/src/esp1/fsr/runtime.clj#L26">view source</a></div></div><div class="public anchor" id="var-match-pattern-route"><h3>match-pattern-route</h3><div class="usage"><code>(match-pattern-route uri method pattern-routes)</code></div><div class="doc"><div class="markdown"><p>Attempts to match URI against pattern routes (parameterized).</p>
<p>Args: - uri: Request URI string - method: HTTP method keyword - pattern-routes: Vector from compile-routes :pattern-routes</p>
<p>Returns: Handler info map with :ns, :handler, :metadata, :path-params, or nil</p>
</div></div><div class="src-link"><a href="https://github.com/esp1/fsr/blob/main/src/esp1/fsr/runtime.clj#L60">view source</a></div></div><div class="public anchor" id="var-match-route"><h3>match-route</h3><div class="usage"><code>(match-route uri method compiled-routes)</code></div><div class="doc"><div class="markdown"><p>Top-level route matching function.</p>
<p>Tries static routes first (O(1)), then pattern routes (O(n)).</p>
<p>Args: - uri: Request URI string - method: HTTP method keyword - compiled-routes: Result from compile-routes</p>
<p>Returns: Handler info map or nil if no match. Handler info includes: - :ns - Namespace symbol - :handler - Handler function symbol - :metadata - Namespace metadata - :path-params - Map of parameter names to values (pattern routes only)</p>
</div></div><div class="src-link"><a href="https://github.com/esp1/fsr/blob/main/src/esp1/fsr/runtime.clj#L89">view source</a></div></div><div class="public anchor" id="var-match-static-route"><h3>match-static-route</h3><div class="usage"><code>(match-static-route uri method static-routes)</code></div><div class="doc"><div class="markdown"><p>Attempts to match URI against static (non-parameterized) routes.</p>
<p>Args: - uri: Request URI string - method: HTTP method keyword (e.g. :post, :put, :delete) - static-routes: Map from compile-routes :static-routes</p>
<p>Returns: Handler info map with :ns, :handler, :metadata, or nil if no match</p>
</div></div><div class="src-link"><a href="https://github.com/esp1/fsr/blob/main/src/esp1/fsr/runtime.clj#L42">view source</a></div></div><div class="public anchor" id="var-require-and-resolve"><h3>require-and-resolve</h3><div class="usage"><code>(require-and-resolve ns-sym handler-sym)</code></div><div class="doc"><div class="markdown"><p>Requires namespace and resolves handler symbol to var.</p>
<p>Args: - ns-sym: Namespace symbol - handler-sym: Handler function symbol (may or may not be namespaced)</p>
<p>Returns: Resolved var or nil if not found</p>
</div></div><div class="src-link"><a href="https://github.com/esp1/fsr/blob/main/src/esp1/fsr/runtime.clj#L114">view source</a></div></div><div class="public anchor" id="var-wrap-compiled-routes"><h3>wrap-compiled-routes</h3><div class="usage"><code>(wrap-compiled-routes handler {:keys [compiled-routes-path compiled-routes response-wrapper], :or {response-wrapper identity}})</code></div><div class="doc"><div class="markdown"><p>Ring middleware that routes requests using pre-compiled routes.</p>
<p>This middleware is designed for production use where you want to avoid filesystem scanning. Routes should be compiled at build time using esp1.fsr.compile/compile-routes.</p>
<p>Options: - :compiled-routes-path - Path to compiled-routes.edn file (string) - :compiled-routes - Pre-loaded compiled routes data structure - :response-wrapper - Optional fn to normalize handler responses (default: identity)</p>
<p>The middleware will: 1. Load compiled routes at initialization (once, not per request) 2. Match incoming requests against compiled routes 3. Invoke matched handlers with enriched request maps 4. Pass through to next handler if no route matches</p>
<p>Handler responses are passed through as-is. If you need response normalization (e.g., string â†’ Ring response), provide a :response-wrapper function.</p>
<p>Example:</p>
<pre><code class="language-clojure">(def app
  (-&gt; not-found-handler
      (wrap-compiled-routes {:compiled-routes-path "dist/compiled-routes.edn"})))
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/esp1/fsr/blob/main/src/esp1/fsr/runtime.clj#L154">view source</a></div></div></div></body></html>